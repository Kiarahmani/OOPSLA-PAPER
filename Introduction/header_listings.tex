\usepackage{xcolor}   % for coloring as emph
\usepackage{etoolbox} % for \ifnumcomp
\usepackage{beramono} % a tt font that has a boldface series
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\lstset{
frame=none,
  language=Java,
  aboveskip=1mm,
  belowskip=1mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\footnotesize\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=2}
% The style to be applied for the highlighted line:
\lstdefinestyle{highlight}{basicstyle=\footnotesize\ttfamily \color{red}, keywordstyle=\color{red}}
%\lstdefinestyle{highlight}{backgroundcolor=\color{orange!30}}

% input listing and emphasize a specific line
% \lstinputemph[listings options]{line number}{filename}
\newcommand{\lstinputemph}[3][\empty]{%                                                    
 \lstset{aboveskip=0pt, belowskip=0pt, showlines=true,#1}%
 \ifnumcomp{#2}{=}{0}{\lstinputlisting{#3}}{%
   \ifnumcomp{#2}{=}{1}{}{\lstinputlisting[lastline=\the\numexpr#2-1\relax]{#3}}%            
   \lstinputlisting[firstnumber={#2},firstline={#2},lastline={#2},style=highlight]{#3}
   \lstinputlisting[firstnumber={\the\numexpr#2+1},firstline=\the\numexpr#2+1\relax]{#3}
 }% else
}
