\begin{definition}
For a given contract ($\psi=\forall(a,b). a
\xrightarrow{Q} b \Rightarrow a \xrightarrow{vis} b $), we define a set
of effects S, to be  $\psi$-consistent under an execution $E$, if and
only if: 
$\forall (\eff \in S). \forall(a\in E.\EffSoup). Q(a,\eta)
\Rightarrow a \in S$ 
\\(We use definition of $Q^{-1}$ from the previous section to formally
define: $Q(a,b) \iff a \in Q_{E.A}^{-1}(b)  $)
\end{definition}

\begin{theorem}
For all operation executions of the form: 
$$
(\E,op_{<s,i>}) 
    \;\xrightarrow{V}\;
  (\E',\eff) 
,$$ 
if $V$ is $\psi$-consistent then $(V\cup\{\eta\})$ is also
$\psi$-consistent.
\end{theorem}
\begin{proof}
Sine $\eff$ is the only effect added to $V$, we only need to check the
following property for $\eta$, in order to prove $\psi$-consistency of
$V\cup\{\eta\}$:
$$\forall (a \in E.A). Q(a,\eta) \Rightarrow vis(a,\eta)  $$
\\
(1) $Q(a,\eta) \spc$ (hypothesis)
\\(2) $a \in Q^{-1}_V (\eta) \spc$  (we need to prove this)
\\(3) $a \in V \spc$ (premise of the rules and (2))
\\(4) $V$ is $\psi$-consistent so from (3) and definition of
consistency, the property holds for $a$
\paragraph{} In order to prove (2), we \emph{probably} have to destruct the contract and
show that if it ends with $so$, the property trivially holds since the
vis set of $\eta$ is fixed. For the other case the premise of the rule
[VIS Exec] will have the enought information to prove.
\end{proof}
\newpage
