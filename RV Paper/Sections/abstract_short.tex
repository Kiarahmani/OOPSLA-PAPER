
  Designing reliable and highly available large-scale applications, unavoidably
  requires replication of data over geo-distributed systems, which
  compromises the simplicity of developing libraries, because
  it forces designers to weigh the correctness
  benefits of guaranteeing strong data consistency, against a potentially
  significant cost in performance. 
  %
  Unfortunately, anomalies possible under weak consistency guarantees
  can endanger operational correctness of the libraries and
  forces designers to either implement
  ad-hoc mechanisms for every operation to avoid these anomalies, or
  choose to run applications on store-offered stronger levels of
  consistency, that may well enforce stronger guarantees than
  required. The former approach introduces unwanted complexity,
  while the latter sacrifices performance.



  In this paper, we describe a lightweight runtime system that is
  based on declarative axiomatic specifications, 
  which reflect the necessary constraints any 
  correct implementation of anomaly avoidance mechanism
  must satisfy.  
  %
  Our runtime enforcement mechanism realizes a \emph{provably optimal} approach
  that imposes no additional communication or
  blocking overhead beyond what is required to satisfy the
  specification and allows each operation to run in a \emph{provably
  safe} environment
  without witnessing any of the specified anomalies. 
  %
  Experimental results show that the
  performance of our automatically derived mechanisms are  better than
  both specialized hand-written protocols, and common store-offered
  consistency guarantees, providing strong evidence of its
  practical utility.
