\section {Specification Language} 
\label{sec:ctrt_language}
\input{Sections/syntax}
The formal syntax of our specification language is presented in
Fig.~\ref{fig:ctrt_syntax}, which allows definition of propositions
(\propS{}), FOL formulae that 
establish dependence relations between effects in order to determine
the effects an operation should witness.
The language is seeded with $\soZ$ and $\visZ$, respectively representing session
order and visibility over effects, 
and defines a \relationS{} as a sequence\footnote{\tool also allows
definition of the closure of relations, however we omitted them here for
simplicity reasons} of relation seeds, representing dependencies between effects,  
which should be desugared as
follows:
\begin{equation} \scriptsize
a \xrightarrow{\rel_1;...;\rel_k} b \iff \exists c. (a
\xrightarrow{\rel_1;...;\rel_{k-1}} c
\wedge c \xrightarrow {\rel_k} b)
\end{equation}
Additionally, the language allows definition of \specS{}, that is a
conjunction of propositions, and is used to define safe environments that are 
free of \emph{multiple} inconsistencies. 
Our language is crafted to capture fine-grained weak consistency
requirements, including the famous session guarantees \cite{terry}, presented
in Fig \ref{fig:ctrt_example}.

%
% UB and LB contracts
%

We finish this section by syntactically classifying 
contracts, and explaining how each of them requires different
enforcement techniques.
\begin{description}
\item {\textsf LB}: If the defined dependency relation for a contract ends with an \soZ, i.e. is of
the following form ({\scriptsize $\forall a. a
\xrightarrow{r_1;r_2;...;\soZ} \hat{\eff}
\Rightarrow a \xrightarrow{\visZ} \hat{\eff}$}), we call it a \emph{lower
bound} (\LB{}) contract, since it specificly defines the smallest set of
effects that any operation should witness to maintain consistency, e.g.
\textsc{rmw} and \textsc{mr} in Fig.~\ref{fig:ctrt_example}.

\item {\textsf UB}: Similarly, we define the \emph{upper bound} (\UB{})
contracts, as the ones with dependency relations ending with a $\visZ$.
These contracts define constraints on the set of effects made visible
to each operation, by enforcing that if an effect is being witnessed
certain set of dependencies must also be witnessed.
\end{description}
Our consistency enforcement approach is based on blocking operations with \LB{}
contracts to make sure that they witness \emph{all effects that they are
supposed to}, and filteration for \UB{} contracts to make sure that they
would not witness \emph{effects that they are not supposed
to}. A combination of both approaches is also taken for contracts that are
neither  \LB{} nor \UB{}, i.e hybrid contracts.

